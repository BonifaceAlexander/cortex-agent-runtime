agent:
  name: invoice_validator
  model: cortex.llama3
  retry_policy:
    max_retries: 3
    retry_on_status: 
      - FAILED
      - TIMEOUT
  steps:
    - name: extract_entities
      type: INSTRUCTION
      instruction: "Extract the vendor name, date, and total amount from the invoice text."
      inputs:
        text: "{{ input.invoice_text }}"
      
    - name: validate_math
      type: TOOL_USE
      tool_name: math_validator
      inputs:
        amount: "{{ steps.extract_entities.output.amount }}"
        
    - name: generate_summary
      type: INSTRUCTION
      instruction: "Generate a JSON summary of the validation results."
